(()=>{const e=document.getElementById("videoContainer"),t=document.getElementById("commentForm"),n=(document.querySelector(".video__comments ul"),document.querySelectorAll(".delete__icon")),a=async t=>{const n=t.target.parentElement,{dataset:{id:a}}=t.target.parentElement,o=e.dataset.id;200===(await fetch(`/api/videos/${o}/comment/delete`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({commentId:a})})).status&&n.remove()};t&&t.addEventListener("submit",(async n=>{n.preventDefault();const o=t.querySelector("textarea"),c=o.value,d=e.dataset.id;if(""===c)return;const m=await fetch(`/api/videos/${d}/comment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:c})});if(201===m.status){o.value="";const{newCommentId:e}=await m.json();((e,t)=>{const n=document.querySelector(".video__comments ul"),o=document.createElement("li");o.dataset.id=t,o.className="video__comment";const c=document.createElement("i");c.className="fas fa-comment";const d=document.createElement("span");d.innerText=` ${e}`;const m=document.createElement("span");m.className="delete__icon",m.innerText="❌",o.append(c),o.appendChild(d),o.appendChild(m),n.prepend(o),m.addEventListener("click",a)})(c,e)}})),n&&n.forEach((e=>e.addEventListener("click",a)))})();