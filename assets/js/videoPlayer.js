(()=>{const e=document.querySelector("video"),t=document.getElementById("play"),a=t.querySelector("i"),n=document.getElementById("mute"),d=n.querySelector("i"),l=document.getElementById("volume"),o=document.getElementById("currentTime"),s=document.getElementById("totalTime"),u=document.getElementById("timeline"),r=document.getElementById("fullScreen"),m=r.querySelector("i"),i=document.getElementById("videoContainer"),c=document.getElementById("videoControls"),v=document.getElementById("textarea"),f=document.getElementById("addComment"),L=document.querySelector("#volume");let E=null,g=null,y=.5,p=!1,T=!1;e.volume=y;const k=t=>{e.paused?e.play():e.pause(),a.classList=e.paused?"fas fa-play":"fas fa-pause"},w=t=>{e.muted?e.muted=!1:e.muted=!0,l.value=e.muted?0:y},x=e=>new Date(1e3*e).toISOString().substring(14,19),h=()=>{document.fullscreenElement?(document.exitFullscreen(),m.classList="fas fa-expand"):(i.requestFullscreen(),m.classList="fas fa-compress")},I=()=>c.classList.remove("showing"),B=()=>{E&&(clearTimeout(E),E=null),g&&(clearTimeout(g),g=null),c.classList.add("showing"),g=setTimeout(I,3e3)};document.addEventListener("keypress",(e=>{"textarea"!==e.target.id&&e.preventDefault()})),document.addEventListener("keydown",(t=>{"Space"==t.code&&"textarea"!==t.target.id&&(k(),B()),"m"!=t.key&&"M"!=t.key||"textarea"===t.target.id||w(),"f"!=t.key&&"F"!=t.key||"textarea"===t.target.id||h(),"ArrowRight"==t.code&&"textarea"!==t.target.id&&(e.currentTime+=5,B()),"ArrowLeft"==t.code&&"textarea"!==t.target.id&&(e.currentTime-=5,B()),"ArrowUp"===t.code&&"textarea"!==t.target.id?(t.preventDefault(),e.volume=Math.min(e.volume+.1,1),L.value=e.volume,B()):"ArrowDown"===t.code&&"textarea"!==t.target.id&&(t.preventDefault(),e.volume=Math.max(e.volume-.1,0),L.value=e.volume,B()),e.volume>=.5?d.classList="fas fa-volume-up":e.volume>=.1?d.classList="fas fa-volume-down":e.volume<=27755575615628914e-33&&(d.classList="fas fa-volume-mute")})),t.addEventListener("click",k),n.addEventListener("click",w),l.addEventListener("input",(t=>{const{target:{value:a}}=t;e.volume=a,y=a,e.volume>=.5?d.classList="fas fa-volume-up":e.volume>=.1?d.classList="fas fa-volume-down":e.volume<=27755575615628914e-33&&(d.classList="fas fa-volume-mute"),e.muted&&(e.muted=!1)})),e.addEventListener("loadedmetadata",(()=>{s.innerText=x(Math.floor(e.duration)),u.max=Math.floor(e.duration)})),e.addEventListener("timeupdate",(()=>{o.innerText=x(Math.floor(e.currentTime)),u.value=Math.floor(e.currentTime),e.currentTime==e.totalTime&&console.log("hi")})),e.addEventListener("click",k),e.addEventListener("ended",(()=>{const{id:e}=i.dataset;fetch(`/api/videos/${e}/view`,{method:"POST"}),a.classList="fa-solid fa-rotate-right"})),u.addEventListener("input",(t=>{const{target:{value:a}}=t;T||(p=!e.paused,T=!0),e.pause(),e.currentTime=a})),u.addEventListener("change",(()=>{p?e.play():e.pause(),T=!1})),r.addEventListener("click",h),i.addEventListener("mousemove",B),i.addEventListener("mouseleave",(()=>{E=setTimeout(I,3e3)})),e.addEventListener("click",(()=>e.focus())),e.addEventListener("keydown",(t=>{e.volume>=.5?d.classList="fas fa-volume-up":e.volume>=.1?d.classList="fas fa-volume-down":e.volume<=27755575615628914e-33&&(d.classList="fas fa-volume-mute")})),v.addEventListener("keydown",(e=>{"Enter"!==e.key&&13!==e.code||(e.preventDefault(),f.click())}))})();